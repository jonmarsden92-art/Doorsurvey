<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Door Survey Application</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1, h2 { color: #333; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { border: 1px solid #ccc; padding: 10px; text-align: left; }
        th { background-color: #f2f2f2; }
        .button { margin: 10px 0; padding: 10px 15px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
        .button:hover { background-color: #45a049; }
    </style>
</head>
<body>
    <h1>Door Survey Application</h1>
    <h2>Project Information</h2>
    <div id="project-info"></div>
    <h2>Notes</h2>
    <div id="notes"></div>
    <h2>Intrusive Survey</h2>
    <div id="intrusive-survey"></div>
    <h2>Door Schedule</h2>
    <div id="door-schedule"></div>
    <h2>Images Metadata</h2>
    <div id="images-metadata"></div>
    <button class="button" id="export-btn">Export to Excel</button>

    <script>
        // Sample Data
        const projectInfo = { "Project Name": "Sample Project", "Location": "123 Main St" };
        const notes = ["Note 1", "Note 2", "Note 3"];
        const intrusiveSurvey = [{ "Location": "Room 101", "Condition": "Good" }];
        const doorSchedule = [{ "Door ID": "D001", "Description": "Front Door" }];
        const imagesMetadata = [{ "Image": "door_1.jpg", "Date Captured": "2026-02-25" }];

        // Display Sample Data
        document.getElementById('project-info').innerHTML = JSON.stringify(projectInfo, null, 2);
        document.getElementById('notes').innerHTML = notes.join('<br/>');
        document.getElementById('intrusive-survey').innerHTML = JSON.stringify(intrusiveSurvey, null, 2);
        document.getElementById('door-schedule').innerHTML = JSON.stringify(doorSchedule, null, 2);
        document.getElementById('images-metadata').innerHTML = JSON.stringify(imagesMetadata, null, 2);

        // Export to Excel Functionality
        document.getElementById('export-btn').addEventListener('click', function () {
            const wb = XLSX.utils.book_new();
            wb.Props = { Title: "Door Survey Export" };

            // Project Info Sheet
            const projectInfoSheet = XLSX.utils.json_to_sheet([projectInfo]);
            XLSX.utils.book_append_sheet(wb, projectInfoSheet, "Project Info");

            // Notes Sheet
            const notesSheet = XLSX.utils.json_to_sheet(notes.map((note, index) => ({ "Note": note })));
            XLSX.utils.book_append_sheet(wb, notesSheet, "Notes");

            // Intrusive Survey Sheet
            const intrusiveSurveySheet = XLSX.utils.json_to_sheet(intrusiveSurvey);
            XLSX.utils.book_append_sheet(wb, intrusiveSurveySheet, "Intrusive Survey");

            // Door Schedule Sheet
            const doorScheduleSheet = XLSX.utils.json_to_sheet(doorSchedule);
            XLSX.utils.book_append_sheet(wb, doorScheduleSheet, "Door Schedule");

            // Images Metadata Sheet
            const imagesMetadataSheet = XLSX.utils.json_to_sheet(imagesMetadata);
            XLSX.utils.book_append_sheet(wb, imagesMetadataSheet, "Images Metadata");

            // Export the file
            XLSX.writeFile(wb, "Door_Survey_Report.xlsx");
        });
    </script>
</body>
</html>